# Simple Malware Fetching

No big crazy thing here .. just simple bash wget/parallel/grep fetches

## First Time Run
```
git clone https://github.com/shadowbq/simple_malware_fetching.git
cd simple_malware_fetching
./fetch_vxvault_pe32.sh
```
## Output

```
[shadowbq@Core](~/simple_malware_fetching)$ ./fetch_vxvault_pe32.sh
[fetch_vxvault_pe32 - 8181] starting using url_timeouts=25.
URL_List.php                                                            [ <=>                                                                                                                                                               ]   4.59K  --.-KB/s    in 0.1s    
[fetch_vxvault_pe32 - 8181] fetching malware..
nethost.exe         100%[===================>] 749.00K   407KB/s    in 1.8s    
wodse.exe           100%[===================>] 777.41K  4.32MB/s    in 0.2s    
JGZNXQ.exe          100%[===================>] 968.35K   668KB/s    in 1.4s    
15.exe              100%[===================>] 359.50K  89.3KB/s    in 4.0s    
Off1c3v4l1dK3y2017s 100%[===================>] 982.57K  1.28MB/s    in 0.8s    
front.exe           100%[===================>]  96.00K   399KB/s    in 0.2s    
search.php              [ <=>                ]       0  --.-KB/s    in 0s      
read.php?f=0.dat        [ <=>                ]     296  --.-KB/s    in 0s      
user.php?f=0.dat        [ <=>                ]     295  --.-KB/s    in 0s      
read.php?f=1.gif    100%[===================>] 315.75K  22.8KB/s    in 14s     
Viyyks.exe              [ <=>                ]   7.29K  --.-KB/s    in 0s      
m.ttl               100%[===================>] 362.00K   373KB/s    in 1.0s    
bd.exe              100%[===================>]     656  --.-KB/s    in 0s      
bankform.exe        100%[===================>]     656  --.-KB/s    in 0s      
download.aspx?docid 100%[===================>]  13.62K  --.-KB/s    in 0s      
DICVFL.exe          100%[===================>]     656  --.-KB/s    in 0s      
r4.php?cmd=e            [   <=>              ] 250.50K   517KB/s    in 0.5s    
1201310150340282788 100%[===================>] 395.50K   389KB/s    in 1.0s    
1201310150322509270 100%[===================>] 395.50K   371KB/s    in 1.1s    
1201310150322065266 100%[===================>] 395.50K   404KB/s    in 1.0s    
1201310150317521926 100%[===================>] 373.00K   439KB/s    in 0.9s    
1201310141849511931 100%[===================>] 395.50K   500KB/s    in 0.8s    
1201310141839549320 100%[===================>] 395.50K   474KB/s    in 0.8s    
1201310141836074477 100%[===================>] 380.50K   388KB/s    in 1.0s    
1201310150338205855 100%[===================>]   2.06M   959KB/s    in 2.2s    
1201310150323591822 100%[===================>]   2.06M   930KB/s    in 2.3s    
1201310150320517481 100%[===================>] 529.09K   449KB/s    in 1.2s    

[fetch_vxvault_pe32 - 8181] deduplication..
   [+] ./malware/1201310150322065266.exe
   [-] ./malware/1201310150322509270.exe

[fetch_vxvault_pe32 - 8181] keeping PE32 files only.. 
./malware:                         directory
./malware/JGZNXQ.exe:              PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310141836074477.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310150338205855.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310150317521926.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/r4.php?cmd=e:            PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310141849511931.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/read.php?f=1.gif:        PE32 executable (GUI) Intel 80386, for MS Windows
./malware/front.exe:               PE32 executable (GUI) Intel 80386, for MS Windows
./malware/m.ttl:                   PE32 executable (GUI) Intel 80386 (stripped to external PDB), for MS Windows
./malware/15.exe:                  PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310150322065266.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310141839549320.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/wodse.exe:               PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows
./malware/nethost.exe:             PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310150340282788.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/Off1c3v4l1dK3y2017s.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310150323591822.exe: PE32 executable (GUI) Intel 80386, for MS Windows
./malware/1201310150320517481.exe: PE32 executable (GUI) Intel 80386, for MS Windows

[fetch_vxvault_pe32 - 8181] done.
```

## Locations for Malware:

http://vxvault.net//URL_List.php


## Basic Idea
```
wget http://vxvault.net//URL_List.php

tail -n +4 ./URL_List.php > URL_List.txt
```


### Fetching using wget:

`wget -nc --timeout=25 -i URL_List.txt`

#### Faster.. 

Interpolate a right trimmed list of URLS to wget without noise

`cat URL_List.txt | parallel --no-run-if-empty --no-notice --trim r --gnu "wget -nc --timeout=25 {}"`

### Cleaning up duplicates:

Generates a list of checksums for any file that matches *

```
$ md5sum * > checklist.chk 
```

Find dupes using `fdupes` (apt-get install fdupes)

```
fdupes -r .
```

Find and remove duplicates

```
fdupes -N -d -r .
```

### Doing Additional things

```
find . -print0 | xargs -0 cmd -option1 -option2 --
```

Examples:

```
$ find . -print0 | xargs -0 file --
.:                                                 directory
./1201511261336435956.exe:                         PE32 executable (GUI) Intel 80386, for MS Windows
./dbust.exe:                                       PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows
./7u65j5hg.exe:                                    HTML document, ASCII text
./1201512232221001235.exe:                         PE32 executable (GUI) Intel 80386, for MS Windows
./10.exe:                                          PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows
./k76j5hg.exe:                                     PE32 executable (GUI) Intel 80386, for MS Windows
./1201601091457012416.exe:                         PE32 executable (GUI) Intel 80386, for MS Windows
./firefox.exe:                                     PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows
./java.exe:                                        PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows
./Grog_by_kolya_at_mirmuz_20151031_1446319217.exe: MS-DOS executable, MZ for MS-DOS
./host9.exe:                                       PE32 executable (GUI) Intel 80386, for MS Windows
./1201512260639527541.exe:                         PE32 executable (GUI) Intel 80386, for MS Windows
./URL_List.txt:                                    ASCII text, with CRLF line terminators
./1201512192145375782.exe:                         PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows
./34frgegrg.exe:                                   HTML document, ASCII text, with CRLF line terminators
./1201601091455416672.exe:                         PE32 executable (GUI) Intel 80386, for MS Windows
./xdg1:                                            ELF 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux), statically linked, stripped
./0oi545gfgf.exe:                                  PE32 executable (GUI) Intel 80386, for MS Windows
./120151225174858648.exe:                          PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows
```
### Find files that are not PE32 samples

```
$  find . -type f -print0 | xargs -0 file -- |grep -v PE32
./URL_List.php:   ASCII text, with CRLF line terminators
./URL_List.txt:   ASCII text, with CRLF line terminators
```

### Rename files without extensions to .exe

```
find . -type f ! -name "*.*" -print0 |xargs -I {} -0 mv {} ./{}.exe
```

### Remove all non PE32 files

```
find . -type f -print0 | xargs -0 file -- |grep -v PE32 |grep -o '^\.\/[^:]*' |xargs -I {} rm -f {}
```
