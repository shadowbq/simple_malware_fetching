#!/bin/bash
command -v wget >/dev/null 2>&1 || { echo >&2 "I require 'wget' but it's not installed.  Aborting."; exit 1; }
command -v parallel >/dev/null 2>&1 || { echo >&2 "I require 'parallel' but it's not installed.  Aborting."; exit 1; }
command -v tail >/dev/null 2>&1 || { echo >&2 "I require 'tail' but it's not installed.  Aborting."; exit 1; }
command -v xargs >/dev/null 2>&1 || { echo >&2 "I require 'xargs' but it's not installed.  Aborting."; exit 1; }
command -v fdupes >/dev/null 2>&1 || { echo >&2 "I require 'fdupes' but it's not installed.  Aborting."; exit 1; }

wget http://vxvault.net//URL_List.php
tail -n +4 ./URL_List.php > URL_List.txt
cat URL_List.txt | parallel --no-run-if-empty --no-notice --trim r --gnu "wget -nc --timeout=25 {}"
fdupes -N -d -r .
find . -print0 | xargs -0 file --
find . -type f ! -name "*.*" -print0 |xargs -I {} -0 mv {} ./{}.exe
find . -type f -print0 | xargs -0 file -- |grep -v PE32 |grep -o '^\.\/[^:]*' |xargs -I {} rm -f {}
